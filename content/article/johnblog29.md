---
title: "Johnblog29"
date: 2019-05-03T12:54:21-07:00
draft: false
Categories: [Comp 481]
Tags: ["John Philip Vinuya", "Sandbox Worms"]
Author: "John Vinuya"
---
This week we were able to use corosync and pacemaker to establish cluster management and reinstate the floating ip to allow access to the Moodle and Lorentz machine. Pacemaker, and by extension, `crm` provides a handy utility for setting a nodes/the firewalls on standby to test if .18 floats to the secondary machine; this will be useful for a demo. The overall process took information from different sources and tutorials, but we chiefly followed [this one](https://medium.com/@yenthanh/high-availability-using-corosync-pacemaker-on-ubuntu-16-04-bdebc6183fc5). However helpful it was, it neglected to mention certain things we needed or would need, come the time we need to manage more than just the floating ip. Among those things included the `crmsh`, cluster management shell which is used for the majority of pacemaker's operations. To start off, corosync need to use `ntp` to synchronize both firewalls so that changes would be reflected on the other, we also needed to go back to fwbuilder to open ports 5404-5406 rather than use direct iptables commands as mentioned in the tutorial. Mario took care of the keygen, `authkey` file for both filewalls and applied the appropriate changes to the `corosync.conf` file, this included defining the cluster nodes for both primary and secondary firewalls. Once we got to Pacemaker, I was able to install `crmsh` verify the status of the cluster, add additional configurations to crm properties, and added our floating ip as a resource, which was also reflected when running `sudo crm status`. By checking `ip addr ls`, I verified .18's presences and was able to access 47.10 and 47.16. Further tests include setting the primary node to standby and letting the ip float to the secondary firewall and vice versa. Proper documentation was also made based on the materials from the various tutorials.
